(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1303:function(t,e,r){t.exports={}},1614:function(t,e,r){"use strict";r(1303)},1972:function(t,e,r){"use strict";r.r(e);r(8),r(6),r(5),r(10),r(7),r(11);var n=r(1),o=r(0),c=(r(9),r(108),r(23),r(34),r(29),r(24),r(121),r(14),r(3)),l=r(994),d=r(1091),m=r(338);r(98);function v(t,e){return f.apply(this,arguments)}function f(){return(f=Object(o.a)(regeneratorRuntime.mark((function t(e,r){var n,o,c,l,d,m,v,f,h,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.categorySlug,o=r.size,c=void 0===o?6:o,l=r.itemSize,d=void 0===l?9:l,m=r.userId,v=void 0===m?0:m,f=r.lastRank,t.prev=1,t.next=4,e({url:"api_v1.0/user/taxonomy/".concat(v,"?size=").concat(c,"&item_size=").concat(d,"&tab=").concat(n).concat(f?"&last_rank="+f:""),method:"get"});case 4:return h=t.sent,data=h.data,t.abrupt("return",data);case 9:throw t.prev=9,t.t0=t.catch(1),t.t0;case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))).apply(this,arguments)}function h(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function y(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var _={name:"CategoryPage",components:{BsLoading:c.BsLoading,BreadCrumb:l.a,BsContainer:c.BsContainer,ComponentLoader:d.a,InfinitePagination:m.a},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var r,n,o,c,l,d,m,f,h,data,_,k,C,w,O,meta,P,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.params,t.route,n=t.error,o=t.store,t.redirect,c=t.$handleError,l=t.$exploreRequest,d=o.getters["auth/isLoggedIn"],m=o.getters["auth/currentUser"],f=!1,h=d&&!f&&o.getters["auth/userId"]||0,6,9,data={isLoggedIn:d,currentUser:m,size:6,itemSize:9,lastCount:0,category:r.category||r.subcategory},e.prev=8,_=+new Date,k={userId:h,size:6,itemSize:9,categorySlug:data.category},e.next=13,v(l,k);case 13:if(C=e.sent,w=C.tabs,O=C.items,meta=C.meta,P=C.tab_data,x=+new Date,o.dispatch("app/storeWebVitalData",{key:"pageData",value:x-_}),O.length){e.next=22;break}return e.abrupt("return",n({statusCode:404,message:"Page not found"}));case 22:return e.abrupt("return",y(y({},data),{},{items:O,tabs:w||{},lastCount:O.length,tabData:P,lastRank:null==meta?void 0:meta.last_rank,showInfinite:!0,error:!1,activeTab:meta.active_tab}));case 25:if(e.prev=25,e.t0=e.catch(8),!f){e.next=29;break}return e.abrupt("return",c(e.t0,!0));case 29:return c(e.t0),e.abrupt("return",y(y({},data),{},{showInfinite:!1,error:!0}));case 31:case"end":return e.stop()}}),e,null,[[8,25]])})))()},data:function(){return{isLoading:!1,currentPage:1}},head:function(){var t,e,r,n,o,c,l,d,m,v,f,h,y=this.$config.baseUrl+this.$route.path,title=(null===(t=this.tabData)||void 0===t||null===(e=t.metadata)||void 0===e||null===(r=e.page)||void 0===r?void 0:r.title)||this.pageTitle,head={link:[{rel:"canonical",href:y}],meta:[]};(title&&(head.title=title,head.meta.push({hid:"og:title",property:"og:title",content:title})),null!==(n=this.tabData)&&void 0!==n&&null!==(o=n.metadata)&&void 0!==o&&null!==(c=o.page)&&void 0!==c&&c.description)&&(head.meta.push({hid:"description",name:"description",content:null===(l=this.tabData)||void 0===l||null===(d=l.metadata)||void 0===d||null===(m=d.page)||void 0===m?void 0:m.description}),head.meta.push({hid:"og:description",property:"og:description",content:null===(v=this.tabData)||void 0===v||null===(f=v.metadata)||void 0===f||null===(h=f.page)||void 0===h?void 0:h.description}));return head},computed:{totalPage:function(){return this.lastCount<this.size?this.currentPage||1:this.currentPage+1},pageTitle:function(){var t;return(null===(t=this.tabData)||void 0===t?void 0:t.title)||""},userId:function(){return this.$store.getters["auth/userId"]||0},breadCrumb:function(){var t;return null===(t=this.items)||void 0===t?void 0:t[0].result.map((function(t,e){var r,n;return{title:null==t||null===(r=t.metadata)||void 0===r?void 0:r.title,link:"/".concat(1===e?"subcategory":"category","/").concat(null==t||null===(n=t.metadata)||void 0===n?void 0:n.slug)}}))}},mounted:function(){this.sendLog()},methods:{fetchData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r,n,o,c,meta,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isLoading){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t.isLoading=!0,r={userId:t.userId,size:t.size,itemSize:t.itemSize,lastRank:t.lastRank,categorySlug:t.category},e.next=7,v(t.$exploreRequest,r);case 7:n=e.sent,o=n.tabs,c=n.items,meta=n.meta,l=n.tab_data,t.error=!1,t.tabs=o,t.tabData=l,t.lastRank=null==meta?void 0:meta.last_rank,t.lastCount=c.length,t.activeTab=meta.active_tab,t.items=t.items.concat(c),c.length<t.size&&(t.showInfinite=!0),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(2),t.$handleError(e.t0);case 25:return e.prev=25,t.isLoading=!1,e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[2,22,25,28]])})))()},sendLog:function(){var t=this;setTimeout((function(){t.$publishEvent((function(t){return t.category_view}))({order_count:t.$store.getters["auth/orderCount"],type_of_user:t.$store.getters["auth/typeOfUser"],category_id:+t.activeTab.split("-")[1],category_name:t.tabData.title})}),1e3)}}},k=(r(1614),r(2)),component=Object(k.a)(_,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"category-page"},[r("BsContainer",{staticClass:"category-page__breadcrumb"},[r("BreadCrumb",{attrs:{items:t.breadCrumb}}),t._v(" "),r("div",[r("h1",{staticClass:"category-page__title"},[t._v(t._s(t.pageTitle))])])],1),t._v(" "),r("ComponentLoader",{attrs:{"page-data":t.items}}),t._v(" "),t.isLoading&&t.error?r("div",[r("BsLoading",{staticClass:"category-page__loading",attrs:{size:"xx"}})],1):t.error?r("div",{staticClass:"category-page__error"},[r("Retry",{on:{retry:t.fetchData}})],1):t.showInfinite?r("InfinitePagination",{attrs:{mode:"infinite",fetch:t.fetchData,page:t.currentPage,"total-page":t.totalPage},on:{"update:page":function(e){t.currentPage=e},"update:totalPage":function(e){t.totalPage=e},"update:total-page":function(e){t.totalPage=e}}}):t._e()],1)}),[],!1,null,"9f7bc8d4",null);e.default=component.exports},989:function(t,e,r){t.exports={}},994:function(t,e,r){"use strict";var n={name:"BreadCrumb",props:{items:{type:Array,required:!0},linkLastItem:{type:Boolean,default:!1}},computed:{lastItem:function(){return this.linkLastItem?this.items.length:this.items.length-1}}},o=(r(995),r(2)),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("nav",[r("ol",{staticClass:"bread-crumb"},[r("li",{staticClass:"bread-crumb__item"},[r("NuxtLink",{staticClass:"bread-crumb__item-link",attrs:{to:"/"}},[t._v("خانه")])],1),t._v(" "),t._l(t.items,(function(e,n){return r("li",{key:n,staticClass:"bread-crumb__item"},[r(n!==t.lastItem?"NuxtLink":"span",{tag:"Component",attrs:{to:n!==t.lastItem?e.link:null}},[t._v("\n        "+t._s(e.title)+"\n      ")])],1)}))],2)])}),[],!1,null,"606fe434",null);e.a=component.exports},995:function(t,e,r){"use strict";r(989)}}]);
//# sourceMappingURL=b3de397.js.map