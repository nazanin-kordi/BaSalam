(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1005:function(e,t,r){"use strict";r(5),r(52),r(58),r(43),r(9),r(108),r(24),r(121),r(92);var n=r(3),o=r(1279),l=r(19),c=(r(8),r(6),r(10),r(7),r(11),r(1)),d=r(0),v=(r(14),r(216)),w=r(49),h=r(17);function y(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?y(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):y(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={name:"ReviewCardReplyInput",components:{BsInput:n.BsInput,BsModal:n.BsModal,BsButton:n.BsButton,ReviewCardInfo:o.a},props:{review:{type:Object,required:!0},isSlide:{type:Boolean,default:!1},onReplying:{type:Boolean,required:!0}},data:function(){return{ReplyText:"",replyLoading:!1}},computed:{isPc:function(){return this.$ua.isFromPc()}},methods:{cancelReply:function(){this.$emit("onCancel")},registerReply:function(){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.replyLoading){t.next=2;break}return t.abrupt("return");case 2:return e.replyLoading=!0,t.prev=3,r={reviewId:+e.review.id,description:e.ReplyText},t.next=7,Object(v.g)(e.$reviewRequest,r);case 7:n=t.sent,o=f(f({id:(new Date).getTime(),description:e.ReplyText,createdAt:Object(w.c)().format("YYYY-MM-DD HH:mm:ss")},n),{},{user:e.currentUser}),e.$emit("onReplyVendor",o),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),Object(h.b)(t.t0);case 15:return t.prev=15,e.replyLoading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[3,12,15,18]])})))()}}},_=r(2),component=Object(_.a)(m,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.isSlide?r("BsModal",{attrs:{size:"md","lock-scroll":"","hide-other-modals":"",show:e.onReplying,"show-close":!e.isPc,title:"نظر عمومی روی تجربه مشتری"},on:{close:e.cancelReply}},[r("ReviewCardInfo",{attrs:{review:e.review}}),e._v(" "),r("div",{staticClass:"review-card__body",domProps:{textContent:e._s(e.review.description)}}),e._v(" "),r("BsInput",{attrs:{"auto-focus":"",type:"textarea",placeholder:"پاسخ شما...",size:e.isPc?"lg":"md"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?e.registerReply.apply(null,arguments):null}},model:{value:e.ReplyText,callback:function(t){e.ReplyText=t},expression:"ReplyText"}}),e._v(" "),r("div",{staticClass:"review-card__reply-form-footer"},[r("BsButton",{attrs:{"full-width":"",label:"ثبت نظر",loading:e.replyLoading,disabled:!e.ReplyText.trim()||e.replyLoading},on:{click:e.registerReply}})],1)],1):e.onReplying?r("div",{staticClass:"review-card__reply-form"},[r("BsInput",{attrs:{"auto-focus":"",type:"textarea",placeholder:"پاسخ شما...",size:e.isPc?"lg":"md"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?e.registerReply.apply(null,arguments):null}},model:{value:e.ReplyText,callback:function(t){e.ReplyText=t},expression:"ReplyText"}}),e._v(" "),r("div",{staticClass:"review-card__reply-form-footer"},[r("BsButton",{staticClass:"ml-3",attrs:{label:"ثبت پاسخ",loading:e.replyLoading,disabled:!e.ReplyText.trim()||e.replyLoading},on:{click:e.registerReply}}),e._v(" "),r("BsButton",{attrs:{variant:"outline",label:"انصراف"},on:{click:e.cancelReply}})],1)],1):e._e()}),[],!1,null,null,null),R=component.exports,C=r(996),O={name:"ReviewCardReply",props:{reviewReply:{type:Object,required:!0},vendorIdentifier:{type:[Number,String],default:null}},computed:{replyDate:function(){return Object(w.d)(this.reviewReply.createdAt).format("D MMMM YYYY")}}},B=(r(1606),Object(_.a)(O,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"review-answer"},[r("div",{staticClass:"review-answer__header"},[r("i",{staticClass:"bi bi-reply"}),e._v(" "),r("span",{staticClass:"review-answer__title"},[e._v("پاسخ غرفه دار")]),e._v(" "),r("span",{staticClass:"review-answer__date",domProps:{textContent:e._s(e.replyDate)}})]),e._v(" "),r("div",{staticClass:"review-answer__body",domProps:{textContent:e._s(e.reviewReply.description)}})])}),[],!1,null,"34b30b43",null).exports),k=(r(20),r(25)),x=r.n(k),P={name:"ReviewCardActions",components:{BsButton:n.BsButton,BsConfirm:n.BsConfirm},props:{product:{type:Object,required:!0},review:{type:Object,required:!0},onReplying:{type:Boolean,default:!1},isSlide:{type:Boolean,default:!1},newReply:{type:Object,default:null},showConversation:{type:Boolean,default:!0},showReviewHistory:{type:Boolean,default:!0}},data:function(){return{ReplyText:"",showReview:!0,likeLoading:!1,deleteLoading:!1,reviewItem:this.review,isShowConfirmDeleteModal:!1}},computed:{isPc:function(){return this.$ua.isFromPc()},isLoggedIn:function(){return this.$store.getters["auth/isLoggedIn"]},vendorIdentifier:function(){var e,t;return null===(e=this.product)||void 0===e||null===(t=e.vendor)||void 0===t?void 0:t.identifier},isVendorOwner:function(){var e,t;return this.currentUser&&this.vendorId&&this.vendorId==(null===(e=this.currentUser)||void 0===e||null===(t=e.vendor)||void 0===t?void 0:t.id)},isOwner:function(){var e,t,r;return this.currentUser&&(null===(e=this.currentUser)||void 0===e?void 0:e.id)==(null===(t=this.review)||void 0===t||null===(r=t.user)||void 0===r?void 0:r.id)},vendorId:function(){var e,t;return null===(e=this.product)||void 0===e||null===(t=e.vendor)||void 0===t?void 0:t.id},currentUser:function(){return this.$store.getters["auth/currentUser"]},isLikedByCurrentUser:{get:function(){var e;return null===(e=this.reviewItem)||void 0===e?void 0:e.isLikedByCurrentUser},set:function(e){this.reviewItem.isLikedByCurrentUser=e}},likeCount:{get:function(){var e;return(null===(e=this.reviewItem)||void 0===e?void 0:e.likeCount)||0},set:function(e){this.reviewItem.likeCount=e}},hasReviewHistory:function(){var e;return this.showReviewHistory&&(null===(e=this.review)||void 0===e?void 0:e.historyCount)>1},historyLabel:function(){var e;return this.hasReviewHistory?(null===(e=this.review)||void 0===e?void 0:e.historyCount)+" تجربه ":""}},methods:{onLike:function(){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isLoggedIn){t.next=3;break}return e.$store.dispatch("authModal/showAuthModal",{redirectTo:window.location.href}),t.abrupt("return");case 3:return t.prev=3,e.likeLoading=!0,r={id:e.review.id,undo:e.isLikedByCurrentUser},t.next=8,Object(v.s)(e.$reviewRequest,r);case 8:e.likeCount=e.isLikedByCurrentUser?e.likeCount-1:e.likeCount+1,e.isLikedByCurrentUser=!e.isLikedByCurrentUser,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),Object(h.b)(t.t0);case 15:return t.prev=15,e.likeLoading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[3,12,15,18]])})))()},deleteReview:function(){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.deleteLoading){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,e.deleteLoading=!0,t.next=6,Object(v.i)(e.$reviewRequest,e.review.id);case 6:e.isShowConfirmDeleteModal=!1,e.$emit("onDelete"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),Object(h.b)(t.t0);case 13:return t.prev=13,e.deleteLoading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[2,10,13,16]])})))()},onDelete:function(){this.isShowConfirmDeleteModal=!0},onReply:function(){this.$emit("onReply")},onReport:function(){x.a.publish(this.events.SHOW_REPORT_MODAL,{source:"REVIEW",entityType:"REVIEW",entityId:this.review.id,reason:this.enums.report.REVIEW})},chatWidthUser:function(){this.PubSub.publish(this.events.SHOW_CHAT_AREA_MODAL,{user:this.reviewItem.user,buttonType:"chatWithCustomerStatic",eventData:{comesFromPage:this.$route.name,comesFromComponent:"review_card",createdAt:this.product.createdAt}})},onShowHistory:function(){this.$emit("showReviewHistory")}}},j=(r(1607),Object(_.a)(P,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:["review-actions",{"review-actions--is-slide":e.isSlide}]},[r("BsButton",{staticClass:"review-actions__vote-btn",attrs:{size:e.isPc?"sm":"xs",color:e.isLikedByCurrentUser?"primary":"black",variant:"outline",loading:e.likeLoading,label:e.likeCount||"مفید بود","side-icon":"bi bi-like-thumb"},on:{click:e.onLike}}),e._v(" "),r("ClientOnly",[!e.isVendorOwner||e.onReplying||e.review.answers.length||e.newReply?!e.isVendorOwner&&e.showConversation&&e.review.isPublic&&e.isLoggedIn&&!e.isOwner?r("div",[r("BsButton",{attrs:{color:"black",variant:"outline","side-icon":"bi bi-chats",label:"مشورت",size:e.isPc?"sm":"xs"},on:{click:e.chatWidthUser}})],1):e._e():r("div",[r("BsButton",{attrs:{size:e.isPc?"sm":"xs",color:"black",variant:"outline",label:"پاسخ به مشتری","side-icon":"bi bi-edit-square"},on:{click:e.onReply}})],1)]),e._v(" "),e.hasReviewHistory?r("div",{staticClass:"review-actions__history-count"},[r("BsButton",{staticClass:"review-actions__history-count-btn",attrs:{size:e.isPc?"sm":"xs",color:"black",variant:"outline",label:e.historyLabel,"side-icon":"bi bi-angle-down"},on:{click:e.onShowHistory}})],1):e._e(),e._v(" "),e.isOwner?r("BsButton",{attrs:{size:e.isPc?"sm":"xs",color:"black",variant:"outline","side-icon":"bi bi-delete"},on:{click:e.onDelete}}):e._e(),e._v(" "),e.isOwner?e._e():r("BsButton",{attrs:{color:"black",variant:"outline","side-icon":"bi bi-report",size:e.isPc?"sm":"xs"},on:{click:e.onReport}}),e._v(" "),r("BsConfirm",{attrs:{show:e.isShowConfirmDeleteModal,loading:e.deleteLoading,title:"حذف تجربه",description:"آیا می‌خواهید این تجربه خرید را حذف کنید؟","phone-confirm-icon":"bi bi-trash","phone-confirm-label":"حذف تجربه","phone-cancel-icon":"bi bi-close","phone-cancel-label":"لغو"},on:{"update:show":function(t){e.isShowConfirmDeleteModal=t},submit:e.deleteReview}})],1)}),[],!1,null,"595cee7d",null).exports);function I(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function M(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?I(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):I(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var L={name:"ReviewHistoryItem",components:{BsTag:n.BsTag,BsInput:n.BsInput,BsAvatar:n.BsAvatar,BsRating:n.BsRating,BsButton:n.BsButton,VariationList:C.a,ReviewCardReply:B,ReviewCardActions:j},props:{product:{type:Object,required:!0},review:{type:Object,required:!0}},data:function(){return{newReply:null,ReplyText:"",onReplying:!1,showReview:!0,replyLoading:!1}},computed:{isPc:function(){return this.$ua.isFromPc()},hasPhoto:function(){return this.review.photo&&this.review.photoLarge.url},vendorIdentifier:function(){var e,t;return null===(e=this.product)||void 0===e||null===(t=e.vendor)||void 0===t?void 0:t.identifier}},methods:{getDefaultImageUrl:l.d,registerReply:function(){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.replyLoading){t.next=2;break}return t.abrupt("return");case 2:return e.replyLoading=!0,t.prev=3,r={reviewId:parseInt(e.review.id),description:e.ReplyText},t.next=7,Object(v.g)(e.$reviewRequest,r);case 7:n=t.sent,e.newReply=M(M({id:(new Date).getTime(),description:e.ReplyText,createdAt:Object(w.c)().format("YYYY-MM-DD HH:mm:ss")},n),{},{user:e.currentUser}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),Object(h.b)(t.t0);case 14:return t.prev=14,e.replyLoading=!1,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[3,11,14,17]])})))()},cancelReply:function(){this.onReplying=!1},onReply:function(){this.onReplying=!0},onDelete:function(){this.showReview=!1},formatReviewDate:function(e){return Object(w.d)(e).format("D MMMM YYYY")}}},S=(r(1608),Object(_.a)(L,(function(){var e,t=this,r=t.$createElement,n=t._self._c||r;return t.showReview?n("div",{staticClass:"review-history-item"},[n("div",{staticClass:"review-history-item__header"},[n("BsAvatar",{attrs:{src:t.review.isPublic&&(null===(e=t.review.user.photo)||void 0===e?void 0:e.small)}}),t._v(" "),n("div",{staticClass:"review-history-item__header-info"},[n("div",[n("span",{staticClass:"review-history-item__header-info-name"},[t._v("\n          "+t._s(t.review.isPublic?t.review.user.name:"دوست باسلامی")+"\n        ")]),t._v(" "),n("BsRating",{attrs:{value:t.review.star||0,size:t.isPc?"md":"sm","read-only":""}})],1),t._v(" "),t.review.createdAt?n("div",{staticClass:"review-history-item__date"},[n("span",{domProps:{textContent:t._s(t.formatReviewDate(t.review.createdAt))}})]):t._e()])],1),t._v(" "),t.review.variationMetadata?n("VariationList",{staticClass:"review-history-item__variation",attrs:{"show-color":"",size:t.$isMobileScreen?"sm":"md",properties:t.review.variationMetadata.properties}}):t._e(),t._v(" "),t.review.description?n("div",{staticClass:"review-history-item__body"},[t._v("\n    "+t._s(t.review.description)+"\n  ")]):t._e(),t._v(" "),t.hasPhoto?n("ExpandableImage",{staticClass:"review-history-item__image",attrs:{"photos-large":t.review.photoLarge.url||t.getDefaultImageUrl()}},[n("img",{staticClass:"lazy",attrs:{alt:"image",src:t.getDefaultImageUrl(),"data-src":t.review.photo.url||t.getDefaultImageUrl()}})]):t._e(),t._v(" "),t.review.reasons&&t.review.reasons.length?n("div",{staticClass:"review-history-item__tags"},t._l(t.review.reasons,(function(label,e){return n("BsTag",{key:e,attrs:{label:label.title,color:"GOOD"===label.type?"success":"danger"}})})),1):t._e(),t._v(" "),t.review.answers.length||t.newReply?n("ReviewCardReply",{staticClass:"review-history-item__replies",attrs:{"review-reply":t.review.answers[0]||t.newReply,"vendor-identifier":t.vendorIdentifier||t.newReply}}):t._e(),t._v(" "),t.review.answers.length||t.newReply?t._e():[t.onReplying?n("div",{staticClass:"review-history-item__reply-form"},[n("BsInput",{attrs:{"auto-focus":"",type:"textarea",placeholder:"پاسخ شما...",size:t.isPc?"lg":"md"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey?t.registerReply.apply(null,arguments):null}},model:{value:t.ReplyText,callback:function(e){t.ReplyText=e},expression:"ReplyText"}}),t._v(" "),n("div",{staticClass:"review-history-item__reply-form__footer"},[n("BsButton",{staticClass:"ml-3",attrs:{label:"ثبت پاسخ",size:t.isPc?"sm":"xs",loading:t.replyLoading,disabled:!t.ReplyText.trim()||t.replyLoading},on:{click:t.registerReply}}),t._v(" "),n("BsButton",{attrs:{variant:"outline",label:"انصراف",size:t.isPc?"sm":"xs"},on:{click:t.cancelReply}})],1)],1):t._e()],t._v(" "),n("ReviewCardActions",{staticClass:"review-history-item__actions",attrs:{product:t.product,review:t.review,"show-conversation":!1,"show-review-history":!1,"on-replying":t.onReplying,"new-reply":t.newReply},on:{onReply:t.onReply,onDelete:t.onDelete}})],2):t._e()}),[],!1,null,"79430721",null)),D=S.exports,U=r(1181),$={name:"ReviewHistory",components:{BsModal:n.BsModal,BsButton:n.BsButton,BsAvatar:n.BsAvatar,BsLoading:n.BsLoading,ReviewHistoryItem:D,ReviewProductItem:U.a},props:{review:{type:Object,required:!0},product:{type:Object,default:null},isShow:{type:Boolean,required:!0}},data:function(){return{loading:!1,hasError:!1,reviewItems:null}},computed:{title:function(){var e;return(null===(e=this.review)||void 0===e?void 0:e.historyCount)+" تجربه برای این محصول"},isPc:function(){return this.$ua.isFromPc()},isLoggedIn:function(){return this.$store.getters["auth/isLoggedIn"]},currentUser:function(){return this.$store.getters["auth/currentUser"]},isOwner:function(){return this.currentUser&&this.currentUser.id==this.review.user.id}},mounted:function(){this.getReviewHistory()},methods:{onClose:function(){this.$emit("onClose")},getReviewHistory:function(){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){var r,n,o,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,e.hasError=!1,t.next=5,Object(v.l)(e.$reviewRequest,null===(r=e.product)||void 0===r?void 0:r.id,null===(n=e.review)||void 0===n||null===(o=n.user)||void 0===o?void 0:o.id);case 5:l=t.sent,c=l.reviews,e.reviewItems=c,t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),e.hasError=!0,Object(h.b)(t.t0);case 14:return t.prev=14,e.loading=!1,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[0,10,14,17]])})))()}}},A=(r(1609),Object(_.a)($,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("BsModal",{attrs:{size:"md",title:e.title,show:e.isShow,"is-internal-scroll":"","show-close":e.$isMobileScreen},on:{close:e.onClose},scopedSlots:e._u([e.isPc?{key:"footer",fn:function(){return[r("BsButton",{staticClass:"mr-auto",attrs:{variant:"outline",label:"بستن"},on:{click:e.onClose}})]},proxy:!0}:null],null,!0)},[r("div",{staticClass:"review-history"},[r("ReviewProductItem",{attrs:{product:e.product,"show-variation":!1}}),e._v(" "),e.hasError?r("div",{staticClass:"review-history__error"},[r("Retry",{on:{retry:e.getReviewHistory}})],1):e.loading?r("div",{staticClass:"review-history__loading"},[r("BsLoading")],1):r("div",{staticClass:"review-history__items"},e._l(e.reviewItems,(function(t){return r("ReviewHistoryItem",{key:t.id,attrs:{product:e.product,review:t}})})),1)],1)])],1)}),[],!1,null,"85a92f86",null).exports),T={name:"ReviewAttachments",components:{Swiper:r(337).a},props:{attachments:{type:Object,default:null},isSlide:{type:Boolean,default:!1},isModal:{type:Boolean,default:!1}},computed:{photos:function(){var e;return null===(e=this.attachments)||void 0===e?void 0:e.photos},defaultImage:function(){return Object(l.d)()},isReviewHaveMedia:function(){var e,t,r;return(null===(e=this.attachments)||void 0===e||null===(t=e.photos)||void 0===t?void 0:t.length)>0||(null===(r=this.attachments)||void 0===r?void 0:r.video)},canUseReviewGallery:function(){var e;return!!this.isReviewHaveMedia&&(null===(e=this.$runGBTest("pdp_photos_gallery_2",null,!1))||void 0===e?void 0:e.value)}}},E=(r(1610),Object(_.a)(T,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"review-attachment",class:[{"review-attachment--is-slide":e.isSlide,"review-attachment--is-modal":e.isModal}]},[r("Swiper",{staticClass:"items-slider",staticStyle:{overflow:"hidden"},attrs:{"disable-in-mobile":!1,options:{slidesPerView:"auto",spaceBetween:8}}},[e.canUseReviewGallery?e._l(e.photos,(function(t,n){return r("img",{key:n,staticClass:"review-attachment__image swiper-slide lazy",attrs:{src:e.defaultImage,"data-src":t.MEDIUM||e.defaultImage},on:{click:function(t){return e.$emit("click-attachment",n)}}})})):e._l(e.photos,(function(t,n){return r("ExpandableImage",{key:n,staticClass:"review-attachment__image swiper-slide",attrs:{"photos-large":t.LARGE||e.defaultImage}},[r("img",{staticClass:"lazy",attrs:{alt:"image",src:e.defaultImage,"data-src":t.MEDIUM||e.defaultImage}})])}))],2)],1)}),[],!1,null,"4643a60a",null).exports),H={name:"ReviewCard",components:{BsTag:n.BsTag,VariationList:C.a,ReviewHistory:A,ReviewCardInfo:o.a,ReviewCardReply:B,ReviewCardActions:j,ReviewAttachments:E,ReviewProductItem:U.a,ReviewCardReplyInput:R,ReviewGalleryModal:function(){return Promise.all([r.e(3),r.e(14),r.e(150)]).then(r.bind(null,1248))}},props:{review:{type:Object,required:!0},product:{type:Object,default:null},isSlide:{type:Boolean,default:!1},maxTextLength:{type:Number,default:null},showUser:{type:Boolean,default:!0},showProductItem:{type:Boolean,default:!0},noBorder:{type:Boolean,default:!1},showActions:{type:Boolean,default:!0},isModal:{type:Boolean,default:!1},showAttachments:{type:Boolean,default:!0}},data:function(){return{newReply:null,onReplying:!1,showReviewCard:!0,isShowReviewHistory:!1,isShowConfirmDeleteModal:!1,isShowReviewGalleryModal:!1,reviewGalleryModalMediaIndex:0}},computed:{isPc:function(){return this.$ua.isFromPc()},hasPhoto:function(){return this.review.photo&&this.review.photoLarge.url},hasReason:function(){var e,t;return(null===(e=this.review)||void 0===e||null===(t=e.reasons)||void 0===t?void 0:t.length)>0},vendorIdentifier:function(){var e,t,r,n,o;return(null===(e=this.review)||void 0===e||null===(t=e.product)||void 0===t||null===(r=t.vendor)||void 0===r?void 0:r.identifier)||(null===(n=this.product)||void 0===n||null===(o=n.vendor)||void 0===o?void 0:o.identifier)},hasAnswer:function(){var e,t;return(null===(e=this.review)||void 0===e||null===(t=e.answers)||void 0===t?void 0:t.length)>0},reviewBody:function(){var body=this.review.description||"";return this.maxTextLength&&body.length>this.maxTextLength?((body=(body=body.substring(0,this.maxTextLength-5)).split(" "))[body.length-1]="...",body.join(" ")):body}},methods:{getProductURL:l.e,onShowHistory:function(){this.isShowReviewHistory=!0},onCloseReviewHistory:function(){this.isShowReviewHistory=!1},onReply:function(){this.onReplying=!0},cancelReply:function(){this.onReplying=!1},onReplyVendor:function(e){this.onReplying=!1,this.newReply=e},onDelete:function(){this.showReviewCard=!1,this.$emit("close"),this.$emit("deleteComponentModal")},openReviewGalleryModal:function(e){this.reviewGalleryModalMediaIndex=e,this.isShowReviewGalleryModal=!0},closeReviewGalleryModal:function(){this.isShowReviewGalleryModal=!1}}},z=(r(1611),Object(_.a)(H,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.showReviewCard?r("div",{class:["review-card",{"review-card--is-pc":e.isPc,"review-card--is-modal":e.isModal,"review-card--is-slide":e.isSlide,"review-card--has-photo":e.hasPhoto,"review-card--has-body":e.reviewBody,"review-card--no-border":e.noBorder,"review-card--has-product":e.showProductItem,"review-card--many-tags":e.review.reasons&&e.review.reasons.length>3}],attrs:{id:"review-"+e.review.id,"data-key":"review-"+e.review.id},on:{click:function(t){return e.$emit("click",t)}}},[e.showProductItem?r("ReviewProductItem",{staticClass:"review-card__product",attrs:{product:e.product}}):e._e(),e._v(" "),r("ReviewCardInfo",{attrs:{"show-user":e.showUser,review:e.review}}),e._v(" "),e.review.variationMetadata&&!e.showProductItem?r("VariationList",{staticClass:"review-card__variation",attrs:{"show-color":"",horizontal:"",size:e.$isMobileScreen?"sm":"md",properties:e.review.variationMetadata.properties}}):e._e(),e._v(" "),r("div",{staticClass:"review-card__body"},[r("span",{domProps:{textContent:e._s(e.reviewBody)}}),e._v(" "),e.reviewBody&&e.review.description&&e.reviewBody!==e.review.description?r("RouterLink",{attrs:{to:e.getProductURL(e.review.product)+"/reviews#review-"+e.review.id}},[e._v("\n      ادامه\n    ")]):e._e()],1),e._v(" "),e.hasReason?r("div",{staticClass:"review-card__tags"},e._l(e.review.reasons,(function(label,e){return r("BsTag",{key:e,attrs:{label:label.title,color:"GOOD"===label.type?"success":"danger"}})})),1):e._e(),e._v(" "),e.showAttachments?r("ReviewAttachments",{attrs:{"is-modal":e.isModal,"is-slide":e.isSlide,attachments:e.review.attachments},on:{"click-attachment":e.openReviewGalleryModal}}):e._e(),e._v(" "),e.isSlide||!e.hasAnswer&&!e.newReply?e._e():r("ReviewCardReply",{staticClass:"review-card__reply",attrs:{"review-reply":e.newReply||e.review.answers[0],"vendor-identifier":e.vendorIdentifier}}),e._v(" "),e.showActions?r("ReviewCardActions",{attrs:{product:e.product?e.product:e.review.product,review:e.review,"on-replying":e.onReplying,"new-reply":e.newReply,"is-slide":e.isSlide},on:{onReply:e.onReply,onDelete:e.onDelete,showReviewHistory:e.onShowHistory}}):e._e(),e._v(" "),e.hasAnswer||e.newReply?e._e():[r("ReviewCardReplyInput",{attrs:{"is-slide":e.isSlide,review:e.review,"on-replying":e.onReplying},on:{onCancel:e.cancelReply,onReplyVendor:e.onReplyVendor}})],e._v(" "),e.isShowReviewHistory?r("ReviewHistory",{attrs:{review:e.review,product:e.product?e.product:e.review.product,"is-show":e.isShowReviewHistory},on:{onClose:e.onCloseReviewHistory}}):e._e(),e._v(" "),r("ClientOnly",[r("ReviewGalleryModal",{attrs:{product:e.product,show:e.isShowReviewGalleryModal,reviews:{reviews:[e.review],totalCount:1},"current-slide-index":e.reviewGalleryModalMediaIndex},on:{close:e.closeReviewGalleryModal}})],1)],2):e._e()}),[],!1,null,null,null));t.a=z.exports},1133:function(e,t,r){e.exports={}},1181:function(e,t,r){"use strict";var n=r(19),o=r(77),l={name:"ReviewProductItem",components:{VariationList:r(996).a},props:{product:{type:Object,required:!0},showVariation:{type:Boolean,default:!0},isPriceAbsolute:{type:Boolean,default:!1}},computed:{imageSource:function(){var e,t;return(null===(e=this.product)||void 0===e||null===(t=e.photo)||void 0===t?void 0:t.url)||Object(n.d)()},productUrl:function(){return Object(n.e)(this.product)},price:function(){var e;return Object(o.numberSeparator)(Object(o.rialToToman)(null===(e=this.product)||void 0===e?void 0:e.price))||" "}},methods:{onClick:function(){this.$router.push(this.productUrl)}}},c=(r(1204),r(2)),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"review-product-item",on:{click:e.onClick}},[r("div",[r("img",{staticClass:"review-product-item__img",attrs:{src:e.imageSource}})]),e._v(" "),r("div",{staticClass:"review-product-item__content"},[r("div",{staticClass:"review-product-item__title"},[e._v(e._s(e.product.name))]),e._v(" "),e.showVariation&&e.product.variation?r("VariationList",{staticClass:"review-product-item__variation",attrs:{"show-color":"",horizontal:"",size:e.$isMobileScreen?"sm":"md",properties:e.product.variation.properties}}):e._e(),e._v(" "),r("div",{staticClass:"review-product-item__price",class:{"review-product-item__price--absolute":e.isPriceAbsolute}},[e._v("\n      "+e._s(e.price)+"\n      "),r("i",{staticClass:"bi bi-toman"})])],1)])}),[],!1,null,null,null);t.a=component.exports},1204:function(e,t,r){"use strict";r(1133)},1279:function(e,t,r){"use strict";var n=r(3),o=r(49),l=r(19),c={name:"ReviewCardInfo",components:{BsAvatar:n.BsAvatar,BsRating:n.BsRating},props:{review:{type:Object,required:!0},showUser:{type:Boolean,default:!0}},computed:{isPc:function(){return this.$ua.isFromPc()},avatarUrl:function(){var e,t,r;return null===(e=this.review)||void 0===e||null===(t=e.user)||void 0===t||null===(r=t.avatar)||void 0===r?void 0:r.url},reviewDate:function(){return Object(o.d)(this.review.createdAt).format("D MMMM YYYY")}},methods:{getUserProfileUrl:l.g}},d=(r(1605),r(2)),component=Object(d.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:["review-card-info",{"review-card-info--without-user":!e.showUser}]},[e.showUser?r("div",{staticClass:"review-card-info__profile"},[r(e.review.isPublic?"nuxt-link":"span",{tag:"Component",attrs:{to:e.review.isPublic?e.getUserProfileUrl(e.review.user):"#"}},[r("BsAvatar",{attrs:{src:e.avatarUrl,size:e.isPc?"lg":"md"}})],1)],1):e._e(),e._v(" "),r("div",[e.showUser?r("div",{staticClass:"review-card-info__name"},[r(e.review.isPublic?"nuxt-link":"span",{tag:"Component",attrs:{to:e.review.isPublic?e.getUserProfileUrl(e.review.user):"#"}},[e._v("\n        "+e._s(e.review.user?e.review.user.name:"کاربر مهمان")+"\n      ")])],1):e._e(),e._v(" "),r("BsRating",{staticClass:"review-card-info__rate",attrs:{value:e.review.star||0,size:e.isPc?"md":"sm","read-only":""}})],1),e._v(" "),e.review.createdAt?r("div",{staticClass:"review-card-info__date"},[r("span",{domProps:{textContent:e._s(e.reviewDate)}})]):e._e()])}),[],!1,null,null,null);t.a=component.exports},1294:function(e,t,r){e.exports={}},1295:function(e,t,r){e.exports={}},1296:function(e,t,r){e.exports={}},1297:function(e,t,r){e.exports={}},1298:function(e,t,r){e.exports={}},1299:function(e,t,r){e.exports={}},1300:function(e,t,r){e.exports={}},1605:function(e,t,r){"use strict";r(1294)},1606:function(e,t,r){"use strict";r(1295)},1607:function(e,t,r){"use strict";r(1296)},1608:function(e,t,r){"use strict";r(1297)},1609:function(e,t,r){"use strict";r(1298)},1610:function(e,t,r){"use strict";r(1299)},1611:function(e,t,r){"use strict";r(1300)},990:function(e,t,r){e.exports={}},996:function(e,t,r){"use strict";r(8),r(9),r(6),r(10),r(7),r(11);var n=r(1),o=(r(5),r(81),r(58),r(346)),l=r(33);function c(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var v={name:"VariationList",components:{ColorBadge:o.a},props:{properties:{type:Array,default:function(){return[]}},size:{type:String,default:"md"},horizontal:{type:Boolean,default:!1},showColor:{type:Boolean,default:!1}},computed:{localProperties:function(){return this.properties.reduce((function(e,t){var r=t.property,n=t.value,o=d(d({},r),{},{values:[n],isColor:Object(l.k)(r.type)}),c=e.find((function(e){return e.id===r.id}));return c?c.values.some((function(e){return e.id===n.id}))||c.values.push(n):e.push(o),e}),[])}}},w=(r(997),r(2)),component=Object(w.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"variation-list",class:["variation-list--size-"+e.size,{"variation-list--horizontal":e.horizontal}]},e._l(e.localProperties,(function(t,n){return r("div",{key:n,staticClass:"variation-list__item"},[r("span",{staticClass:"variation-list__title",domProps:{textContent:e._s(t.title+":")}}),e._v(" "),e._l(t.values,(function(n,o){return[o?r("span",{key:"sp_"+o,staticClass:"variation-list__value-separator"},[e._v("و")]):e._e(),e._v(" "),r("div",{key:o,staticClass:"variation-list__value"},[r("span",{staticClass:"variation-list__value-name",domProps:{textContent:e._s(n.title)}}),e._v(" "),e.showColor&&t.isColor?r("ColorBadge",{attrs:{color:n.value,size:"sm"}}):e._e()],1)]}))],2)})),0)}),[],!1,null,"15adbb71",null);t.a=component.exports},997:function(e,t,r){"use strict";r(990)}}]);
//# sourceMappingURL=9dc5568.js.map